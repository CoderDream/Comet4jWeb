<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Comet4J Hello World</title>
<script type="text/javascript" src="js/comet4j.js"></script>
<script type="text/javascript">
	function getMeasureValue(comPort) {
		var kbDom1 = document.getElementById('kb1');
		var kbDom2 = document.getElementById('kb2');
		var kbDom3 = document.getElementById('kb3');
		//alert('COM Port: ' + comPort.value);

		if (comPort.value == 'COM1') {
			getMeasureValue1();
			kbDom1.style.display = "";
			kbDom2.style.display = "none";
			kbDom3.style.display = "none";
		} else if (comPort.value == 'COM2') {
			getMeasureValue2();
			kbDom1.style.display = "none";
			kbDom2.style.display = "";
			kbDom3.style.display = "none";
		} else if (comPort.value == 'COM3') {
			getMeasureValue3();
			kbDom1.style.display = "none";
			kbDom2.style.display = "none";
			kbDom3.style.display = "";
		}
	}

	function getMeasureValue1() {
		var kbDom = document.getElementById('kb1');
		//alert('COM Port: ' + comPort.value);
		JS.Engine.on({
			hello : function(kb) {//侦听一个channel
				//var freeMemory = kb.freeMemory;
				//alert(kb.COM1);
				//alert(kb.COM2);
				//alert(kb.COM3);
				var json = eval("(" + kb + ")");
				kbDom.innerHTML = 'COM1: ' + json.COM1;
			}
		});
		JS.Engine.start('conn');
	}

	function getMeasureValue2() {
		var kbDom = document.getElementById('kb2');
		//alert('COM Port: ' + comPort.value);
		JS.Engine.on({
			hello : function(kb) {//侦听一个channel
				//var freeMemory = kb.freeMemory;
				//alert(kb.COM1);
				//alert(kb.COM2);
				//alert(kb.COM3);
				var json = eval("(" + kb + ")");
				kbDom.innerHTML = 'COM2: ' + json.COM2;
			}
		});
		JS.Engine.start('conn');
	}

	function getMeasureValue3() {
		var kbDom = document.getElementById('kb3');
		//alert('COM Port: ' + comPort.value);
		JS.Engine.on({
			hello : function(kb) {//侦听一个channel
				var json = eval("(" + kb + ")");
				kbDom.innerHTML = 'COM3: ' + json.COM3;
			}
		});
		JS.Engine.start('conn');
	}
</script>
</head>
<body>
	剩余内存：
	<span id="kb1">...............</span>
	<span id="kb2" style="display: none;">...............</span>
	<span id="kb3" style="display: none;">...............</span> KB
	<br />
	<form method="post" action="">
		<select name="">
			<option value="COM1" onclick="getMeasureValue(this)"
				selected="selected">COM1</option>
			<option value="COM2" onclick="getMeasureValue(this)">COM2</option>
			<option value="COM3" onclick="getMeasureValue(this)">COM3</option>
		</select>
	</form>
</body>
</html>